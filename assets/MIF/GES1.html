<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activity Content | Golden Ear</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --gold: #f59e0b; --bg-deep: transparent; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg-deep); color: white; margin: 0; padding: 15px; overflow-x: hidden; }
        .orbitron { font-family: 'Orbitron', sans-serif; }
        .gold-card { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); border: 1px solid rgba(245, 158, 11, 0.1); border-radius: 25px; }
        
        /* Audio Player Styling */
        .audio-wave-btn {
            width: 60px; height: 60px; background: var(--gold); color: #000; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; font-size: 24px;
            box-shadow: 0 0 20px rgba(245, 158, 11, 0.3); transition: 0.3s;
        }
        .skip-btn {
            width: 40px; height: 40px; background: rgba(255,255,255,0.05);
            border: 1px solid var(--gold); border-radius: 50%; display: flex;
            align-items: center; justify-content: center; color: var(--gold); font-size: 14px;
        }
        
        .question-card {
            background: rgba(255,255,255,0.02); border-right: 3px solid var(--gold);
            transition: 0.3s; padding: 15px; border-radius: 12px;
        }
        .gold-text { background: linear-gradient(to bottom, #fff, var(--gold)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: var(--gold); border-radius: 10px; }
    </style>
</head>
<body>

    <div class="w-full max-w-2xl mx-auto">
        <div class="gold-card p-6 mb-8 text-center relative overflow-hidden">
            <div id="audioStatus" class="text-yellow-500 text-[10px] orbitron mb-4 animate-pulse italic">INITIALIZING AUDIO SYSTEM...</div>
            
            <audio id="mainAudio">
                <source id="audioSource" src="" type="audio/wav">
            </audio>

            <div class="flex justify-center items-center gap-6">
                <button onclick="skip(-5)" class="skip-btn"><i class="fas fa-backward"></i></button>
                <button onclick="togglePlay()" id="playBtn" class="audio-wave-btn">
                    <i id="playIcon" class="fas fa-play"></i>
                    <i id="pauseIcon" class="fas fa-pause hidden"></i>
                </button>
                <button onclick="skip(5)" class="skip-btn"><i class="fas fa-forward"></i></button>
            </div>

            <div class="mt-8 px-2">
                <div class="w-full bg-white/5 h-1.5 rounded-full overflow-hidden cursor-pointer" onclick="seek(event)">
                    <div id="progressBar" class="bg-gradient-to-r from-yellow-600 to-yellow-400 h-full rounded-full transition-all duration-75" style="width: 0%"></div>
                </div>
                <div class="flex justify-between mt-2 text-[9px] text-gray-500 orbitron">
                    <span id="currentTime">00:00</span>
                    <span id="duration">00:00</span>
                </div>
            </div>
        </div>

        <div class="space-y-3 mb-8">
            <h3 class="text-lg font-black gold-text mb-4 italic text-left orbitron">ANALYSIS QUERIES:</h3>
            
            <div id="questionsContainer" class="space-y-3">
                </div>
        </div>

        <div class="text-center pb-10">
            <a id="submitLink" href="#" target="_blank" 
               class="inline-flex items-center gap-3 bg-yellow-500 text-black px-8 py-3 rounded-full font-black text-lg hover:scale-105 transition-transform shadow-lg">
                <span>SUBMIT ANSWERS</span>
                <i class="fas fa-paper-plane"></i>
            </a>
        </div>
    </div>

<script>
    const audio = document.getElementById('mainAudio');
    const progressBar = document.getElementById('progressBar');
    const playIcon = document.getElementById('playIcon');
    const pauseIcon = document.getElementById('pauseIcon');
    
    // جلب رقم المهمة من الرابط
    const params = new URLSearchParams(window.location.search);
    const mNum = params.get('m') || '1';

    // بيانات المهام (يمكنك تعديل الأسئلة هنا لكل مهمة)
    const geData = {
        "1": {
            audio: "assets/audio/GE1.wav",
            form: "https://docs.google.com/forms/d/e/1FAIpQLSdUSOjkoVHtb9sPQXeJX8KQG2oJ71EgkrsSt0q33e8zDaf_Fw/viewform",
            questions: [
                "What is the foundation of scientific inquiry?",
                "What is the core definition of critical thinking?",
                "What is one thing critical thinking helps individuals avoid?",
                "What two qualities are required to develop critical thinking?",
                "Where is critical thinking considered a vital skill?"
            ]
        }
    };

    window.onload = () => {
        const data = geData[mNum] || geData["1"];
        document.getElementById('audioSource').src = data.audio;
        document.getElementById('submitLink').href = data.form;
        audio.load();

        const container = document.getElementById('questionsContainer');
        container.innerHTML = data.questions.map((q, i) => `
            <div class="question-card text-left" dir="ltr">
                <span class="text-yellow-500 font-black orbitron text-[9px] block mb-1">QUERY 0${i+1}</span>
                <p class="text-sm text-gray-200">${q}</p>
            </div>
        `).join('');
    };

    async function togglePlay() {
        if (audio.paused) {
            await audio.play();
            playIcon.classList.add('hidden');
            pauseIcon.classList.remove('hidden');
        } else {
            audio.pause();
            playIcon.classList.remove('hidden');
            pauseIcon.classList.add('hidden');
        }
    }

    function skip(time) { audio.currentTime += time; }

    function formatTime(s) {
        let m = Math.floor(s / 60);
        s = Math.floor(s % 60);
        return (m < 10 ? '0' + m : m) + ':' + (s < 10 ? '0' + s : s);
    }

    audio.ontimeupdate = () => {
        progressBar.style.width = (audio.currentTime / audio.duration) * 100 + '%';
        document.getElementById('currentTime').innerText = formatTime(audio.currentTime);
    };

    audio.onloadedmetadata = () => {
        document.getElementById('duration').innerText = formatTime(audio.duration);
        document.getElementById('audioStatus').innerText = "SYSTEM READY - LISTEN CAREFULLY";
    };

    function seek(e) {
        const percent = e.offsetX / e.target.offsetWidth;
        audio.currentTime = percent * audio.duration;
    }

    // بروتوكول التوافق مع Terminal
    window.checkAnswers = function() {
        return { status: "COMPLETED", points: 1 };
    };
</script>
</body>
</html>
