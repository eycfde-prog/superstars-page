<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grammar X - The Language Hunter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;600&family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #d4af37;
            --dark-gold: #996515;
            --xbox-green: #107c10;
        }
        body {
            background-color: #050505;
            color: white;
            font-family: 'Exo 2', sans-serif;
            background-image: radial-gradient(circle at 50% 50%, #1a1a1a 0%, #050505 100%);
            min-height: 100vh;
        }
        .header-font { font-family: 'Orbitron', sans-serif; }
        
        .gold-border {
            border: 1px solid rgba(212, 175, 55, 0.3);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.1);
        }
        
        .gold-gradient-text {
            background: linear-gradient(to bottom, #f1c40f, #d4af37, #996515);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .input-field {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(212, 175, 55, 0.2);
            color: white;
            transition: all 0.3s ease;
        }
        .input-field:focus {
            outline: none;
            border-color: var(--gold);
            background: rgba(212, 175, 55, 0.1);
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.2);
        }

        .glow-button {
            background: linear-gradient(135deg, var(--dark-gold), var(--gold));
            color: black;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-family: 'Orbitron';
        }
        .glow-button:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 0 30px var(--gold);
        }
        
        .task-card {
            background: rgba(15, 15, 15, 0.8);
            backdrop-filter: blur(12px);
            border-radius: 24px;
        }

        .hidden-section { display: none; }
        
        /* Mission Badge Style */
        .mission-badge {
            background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.1), transparent);
            border-top: 1px solid rgba(212, 175, 55, 0.2);
            border-bottom: 1px solid rgba(212, 175, 55, 0.2);
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-4xl mx-auto">
        <div class="text-center mb-12 relative">
            <h1 class="header-font text-5xl md:text-7xl font-black gold-gradient-text tracking-tighter mb-2">GRAMMAR X</h1>
            <p class="text-[10px] tracking-[0.5em] text-gray-500 uppercase">Season: The Language Hunter | HQ Environment</p>
        </div>

        <div id="loginSection" class="task-card p-10 gold-border text-center max-w-md mx-auto">
            <div class="w-16 h-16 bg-yellow-500/10 rounded-full flex items-center justify-center mx-auto mb-6 border border-yellow-500/30">
                <svg class="w-8 h-8 text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04a11.357 11.357 0 00-1.573 1.13c-.174.145-.351.293-.532.443a11.333 11.333 0 00-1.574 1.13c.01.01.02.02.03.03a11.946 11.946 0 004.654 5.093c.3.176.611.332.932.466a11.947 11.947 0 005.132 1.166c.333 0 .661-.017.983-.051a11.947 11.947 0 005.132-1.166c.321-.134.632-.29.932-.466a11.947 11.947 0 004.654-5.093l.03-.03a11.333 11.333 0 00-1.574-1.13c-.181-.15-.358-.298-.532-.443a11.357 11.357 0 00-1.573-1.13z"/>
                </svg>
            </div>
            <h2 class="header-font text-[#d4af37] text-lg mb-6 tracking-widest">ACCESS REQUIRED</h2>
            <input type="text" id="emailInput" class="input-field w-full py-4 px-6 rounded-xl mb-4 text-center text-lg font-bold" placeholder="Email or Student Code">
            <div id="errorMessage" class="mb-4 text-red-500 text-xs font-bold hidden bg-red-900/10 p-2 border border-red-500/20 rounded"></div>
            <button onclick="handleLogin()" id="loginBtn" class="glow-button w-full py-4 rounded-xl shadow-lg">INITIALIZE LINK</button>
        </div>

        <div id="activitySection" class="hidden-section">
            <div class="task-card p-6 gold-border mb-8 flex justify-between items-center border-l-4 border-l-[#d4af37]">
                <div class="flex items-center gap-4">
                    <div class="h-10 w-10 bg-gold rounded-full flex items-center justify-center text-black font-black">?</div>
                    <div>
                        <p class="text-gray-500 text-[10px] uppercase tracking-widest font-black">Active Hunter</p>
                        <p id="displayEmail" class="text-white font-bold">---</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-gray-500 text-[10px] uppercase tracking-widest font-black">Sector Code</p>
                    <p id="displayCode" class="text-[#d4af37] font-mono font-bold">---</p>
                </div>
            </div>

            <div class="task-card p-8 gold-border mb-10 relative overflow-hidden">
                <div class="absolute top-0 right-0 p-2 bg-[#d4af37] text-black text-[9px] font-black uppercase">Target Text</div>
                <div id="passageDisplay" class="text-xl md:text-2xl font-light italic leading-relaxed text-gray-200 py-4">
                    The modern world is changing rapidly due to amazing technology. Small robots are now helping doctors in busy hospitals to perform difficult surgeries. Yesterday, a famous scientist spoke about the future of artificial intelligence. He claimed that smart machines will eventually learn to think like humans. Many people feel excited, but others are worried about their jobs. In the silence of the laboratory, the scientist carefully examined a new microchip. It was glowing with a faint blue light. This tiny invention could potentially solve many global problems. We must understand that progress requires patience and continuous learning..
                </div>
            </div>

            <form id="grammarForm" class="space-y-6">
                <div id="requirementsContainer" class="space-y-6">
                    <script>
                        const missions = [
                            { title: "5 Action Verbs", reward: "50 TK" },
                            { title: "5 Adjectives", reward: "50 TK" },
                            { title: "5 Prepositions", reward: "50 TK" },
                            { title: "5 Adverbs", reward: "50 TK" }
                        ];

                        missions.forEach((m, idx) => {
                            document.write(`
                            <div class="task-card p-6 border border-white/5 hover:border-[#d4af37]/30 transition-all group">
                                <div class="flex justify-between items-center mb-6">
                                    <h4 class="text-[#d4af37] font-black header-font text-sm uppercase tracking-widest">Mission ${idx+1}: ${m.title}</h4>
                                    <span class="text-[9px] bg-white/5 px-3 py-1 rounded-full text-gray-400 font-bold tracking-tighter">${m.reward}</span>
                                </div>
                                <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
                                    ${[1,2,3,4,5].map(n => `<input type="text" placeholder="Entry ${n}" class="input-field p-3 rounded-lg text-sm mission-input" required>`).join('')}
                                </div>
                            </div>
                            `);
                        });
                    </script>
                </div>

                <div class="text-center pt-10">
                    <button type="submit" id="submitBtn" class="glow-button px-16 py-5 rounded-2xl text-xl shadow-2xl">
                        TRANSMIT DATA
                    </button>
                    <p id="statusMsg" class="mt-6 text-xs font-black uppercase tracking-[0.3em] text-gray-500"></p>
                </div>
            </form>
        </div>

        <footer class="mt-20 text-center text-gray-700 text-[9px] tracking-[0.6em] uppercase pb-10">
            &copy; 2026 EYC ACADEMY | X-SYSTEM SECURE NODE
        </footer>
    </div>

    <script>
        const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxRkYp14qpPdZJvq6f_T0NPKRGVoSUfcjWTZoSzZhbegKGc4QnsKwyx2jr52sl7vQIi_g/exec";
        let currentUserKey = "";

        async function handleLogin() {
            const input = document.getElementById('emailInput').value.trim();
            const btn = document.getElementById('loginBtn');
            const err = document.getElementById('errorMessage');
            
            if (input.length < 3) return;

            btn.disabled = true;
            btn.innerText = "AUTHENTICATING...";
            err.classList.add('hidden');

            try {
                const response = await fetch(`${APPS_SCRIPT_URL}?action=check&email=${encodeURIComponent(input)}`);
                const data = await response.json();

                if (data.status === "authorized") {
                    currentUserKey = none;
                    document.getElementById('displayEmail').innerText = data.email;
                    document.getElementById('displayCode').innerText = data.studentCode;
                    document.getElementById('loginSection').classList.add('hidden-section');
                    document.getElementById('activitySection').classList.remove('hidden-section');
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                } else {
                    err.innerText = data.status === "already_done" ? "MISSION PREVIOUSLY COMPLETED" : "INVALID IDENTIFICATION";
                    err.classList.remove('hidden');
                }
            } catch (e) {
                err.innerText = "HQ CONNECTION ERROR";
                err.classList.remove('hidden');
            } finally {
                btn.disabled = false;
                btn.innerText = "INITIALIZE LINK";
            }
        }

        document.getElementById('grammarForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = document.getElementById('submitBtn');
            const status = document.getElementById('statusMsg');
            
            btn.disabled = true;
            status.textContent = 'TRANSMITTING ENCRYPTED DATA...';

            let fullAnswer = "";
            const missionCards = document.querySelectorAll('#requirementsContainer > div');
            
            missionCards.forEach((card) => {
                const title = card.querySelector('h4').innerText;
                const vals = Array.from(card.querySelectorAll('input')).map(i => i.value).join(', ');
                fullAnswer += `[${title}: ${vals}] | `;
            });

            try {
                const finalUrl = `${APPS_SCRIPT_URL}?action=submit_all&userKey=${encodeURIComponent(currentUserKey)}&answers=${encodeURIComponent(fullAnswer)}`;
                await fetch(finalUrl, { method: 'GET', mode: 'no-cors' });

                status.textContent = 'DATA SECURED. MISSION ACCOMPLISHED.';
                status.classList.replace('text-gray-500', 'text-[#107c10]');
                
                document.getElementById('grammarForm').innerHTML = `
                    <div class="p-12 text-center gold-border rounded-3xl bg-green-900/10 animate-pulse">
                        <h2 class="header-font text-3xl text-[#107c10] mb-4">COMPLETED!</h2>
                        <p class="text-gray-400 tracking-widest font-bold">Your data has been logged in the Academy database.</p>
                    </div>`;
            } catch (error) {
                status.textContent = 'TRANSMISSION FAILED. RETRY.';
                btn.disabled = false;
            }
        });

        window.onbeforeunload = () => currentUserKey ? "Abandon mission? Progress will be lost!" : null;
    </script>
</body>
</html>

