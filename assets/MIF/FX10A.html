<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activity Content | Figurative Focus X</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Orbitron:wght@400;700;900&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --gold: #d4af37; --glass: rgba(255, 255, 255, 0.05); }
        
        body { background: transparent; color: white; margin: 0; padding: 15px; font-family: 'Montserrat', sans-serif; }

        .dialogue-card { 
            background: rgba(0, 0, 0, 0.4); border-radius: 20px; padding: 20px; 
            border: 1px solid rgba(255,255,255,0.1); 
        }

        .dialogue-line { 
            border-left: 2px solid var(--gold); padding: 12px 15px; 
            margin-bottom: 12px; background: rgba(255,255,255,0.02); 
            border-radius: 0 12px 12px 0; font-size: 14px;
        }

        .speaker { 
            font-family: 'Cinzel'; color: var(--gold); font-size: 10px; 
            font-weight: 900; margin-bottom: 4px; display: block; letter-spacing: 1px; 
        }

        .text { font-style: italic; color: #ccc; line-height: 1.5; }

        /* Target Phrase Box */
        .target-box { 
            background: rgba(212, 175, 55, 0.08); border: 1px dashed var(--gold); 
            padding: 20px; border-radius: 15px; text-align: center; margin: 20px 0; 
        }
        .target-box h4 { font-family: 'Cinzel'; font-size: 9px; color: var(--gold); margin-bottom: 8px; letter-spacing: 2px; }
        .target-phrase { 
            font-family: 'Cinzel'; font-size: 22px; font-weight: 900; 
            background: linear-gradient(to right, #fff, var(--gold)); 
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; 
        }

        /* Analysis Area */
        textarea { 
            width: 100%; height: 100px; background: rgba(0,0,0,0.5); 
            border: 1px solid #444; border-radius: 12px; padding: 15px; 
            color: white; margin-top: 10px; resize: none; font-size: 13px;
        }
        textarea:focus { border-color: var(--gold); outline: none; }

        .btn-submit {
            width: 100%; padding: 15px; border-radius: 12px; font-family: 'Cinzel'; font-weight: 900;
            margin-top: 15px; border: none; cursor: pointer; transition: 0.4s;
            background: linear-gradient(135deg, #996515 0%, #d4af37 50%, #f1c40f 100%); color: black;
            font-size: 13px;
        }
        .btn-submit:disabled { opacity: 0.5; filter: grayscale(1); cursor: not-allowed; }
        
        #statusMsg { text-align: center; margin-top: 10px; font-size: 10px; font-family: 'Orbitron'; }
    </style>
</head>
<body>

    <div class="dialogue-card">
        <h3 style="font-family: 'Cinzel'; font-size: 12px; color: var(--gold); margin-bottom: 15px; letter-spacing: 1px;">THE DIALOGUE:</h3>
        
        <div id="dialogueContainer">
            <div class="dialogue-line">
                <span class="speaker">Speaker A</span>
                <p class="text">"I’m so nervous about the final presentation tomorrow..."</p>
            </div>
            <div class="dialogue-line">
                <span class="speaker">Speaker B</span>
                <p class="text">"Don't worry. Just go out there and break a leg!"</p>
            </div>
        </div>

        <div class="target-box">
            <h4>THE TARGETED PHRASE</h4>
            <p id="targetPhrase" class="target-phrase">"break a leg!"</p>
        </div>

        <div class="analysis-area">
            <h3 style="font-family: 'Cinzel'; font-size: 12px; color: white;">YOUR INTERPRETATION:</h3>
            <textarea id="studentResponse" placeholder="Explain the meaning based on the context..."></textarea>
            
            <button class="btn-submit" id="submitBtn" onclick="submitAnswer()">SUBMIT ANALYSIS</button>
            <p id="statusMsg"></p>
        </div>
    </div>

<script>
    const params = new URLSearchParams(window.location.search);
    const mNum = params.get('m') || '1';
    
    // بيانات المهام (يمكنك زيادتها)
    const missionData = {
        "1": {
            target: '"break a leg!"',
            dialogue: [
                { s: "Speaker A", t: '"I’m so nervous about the final presentation tomorrow; I feel like I might forget everything."' },
                { s: "Speaker B", t: '"Don\'t worry, you\'ve worked harder than anyone else. Just go out there and break a leg!"' }
            ]
        }
    };

    window.onload = () => {
        const data = missionData[mNum] || missionData["1"];
        document.getElementById('targetPhrase').innerText = data.target;
        
        const container = document.getElementById('dialogueContainer');
        container.innerHTML = data.dialogue.map(line => `
            <div class="dialogue-line">
                <span class="speaker">${line.s}</span>
                <p class="text">${line.t}</p>
            </div>
        `).join('');
    };

    async function submitAnswer() {
        const response = document.getElementById('studentResponse').value.trim();
        const submitBtn = document.getElementById('submitBtn');
        const statusMsg = document.getElementById('statusMsg');

        if (!response) return;

        submitBtn.disabled = true;
        statusMsg.innerText = "TRANSMITTING TO ACADEMY...";
        statusMsg.style.color = "var(--gold)";

        try {
            // هنا نرسل البيانات للفورم أو السكريبت الخاص بك
            const APPS_SCRIPT_URL = "YOUR_SCRIPT_URL"; 
            // ملاحظة: يُفضل استخدام نظام الـ Terminal الرئيسي للإرسال
            
            statusMsg.innerText = "ANALYSIS RECEIVED ✅";
            statusMsg.style.color = "#4CAF50";
            submitBtn.innerText = "MISSION COMPLETED";
            document.getElementById('studentResponse').disabled = true;
        } catch (e) {
            statusMsg.innerText = "TRANSMISSION FAILED!";
            statusMsg.style.color = "#ff3c3c";
            submitBtn.disabled = false;
        }
    }

    // بروتوكول التوافق مع Terminal
    window.checkAnswers = function() {
        const val = document.getElementById('studentResponse').value;
        return {
            status: val.length > 5 ? "COMPLETED" : "IN_PROGRESS",
            points: val.length > 5 ? 1 : 0
        };
    };
</script>
</body>
</html>
