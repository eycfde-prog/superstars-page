<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EYC Activity Hub | Glassy Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <style>
        :root {
            --primary-bg: #050505;
            --accent-gold: #ffcc00;
            --season-color: #00ffa3;
            --xbox-color: #ff4d4d; /* لون أحمر أخف وأشيك */
            --season-grad: linear-gradient(135deg, rgba(0, 255, 163, 0.3), rgba(0, 128, 255, 0.1));
            --xbox-grad: linear-gradient(135deg, rgba(255, 77, 77, 0.3), rgba(255, 150, 0, 0.1));
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Cairo', sans-serif; }
        body { background: var(--primary-bg); color: #fff; overflow: hidden; height: 100vh; position: relative; }

        /* الخلفية السابحة والنجوم */
        #rank-canvas { position: fixed; inset: 0; z-index: -1; opacity: 0.5; }
        .bg-text-layer {
            position: fixed; inset: 0; z-index: -2; overflow: hidden; pointer-events: none;
        }
        .swimming-text {
            position: absolute; font-family: 'Orbitron'; color: rgba(255, 204, 0, 0.05);
            font-size: 4rem; font-weight: 900; white-space: nowrap;
            transform: rotate(-15deg); animation: swim 20s linear infinite;
        }

        @keyframes swim {
            from { transform: translate(100vw, 100vh) rotate(-15deg); }
            to { transform: translate(-100%, -100%) rotate(-15deg); }
        }

        /* اسم الطالب المشع */
        .student-sparkle {
            position: fixed; top: 20px; right: 20px; z-index: 1000;
            font-family: 'Orbitron'; font-weight: 900; color: #fff;
            text-shadow: 0 0 10px var(--accent-gold), 0 0 20px var(--accent-gold);
            font-size: 1.2rem; display: none;
        }
        .spark {
            position: absolute; width: 4px; height: 4px; background: var(--accent-gold);
            border-radius: 50%; pointer-events: none;
        }

        /* دوائر البروفايل المجمعة */
        .profile-cluster {
            position: fixed; bottom: 30px; left: 30px; z-index: 1000;
            display: flex; flex-direction: column; align-items: center; gap: 15px;
        }
        .float-circle {
            border-radius: 50%; border: 3px solid var(--accent-gold);
            background: rgba(0,0,0,0.8); backdrop-filter: blur(10px);
            box-shadow: 0 0 20px rgba(255,204,0,0.4); 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .main-img-circle { width: 90px; height: 90px; cursor: pointer; position: relative; }
        .main-img-circle img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; }
        .token-circle { width: 75px; height: 75px; font-weight: 900; color: var(--accent-gold); border-width: 4px; }
        .rank-circle { width: 60px; height: 60px; border-color: #fff; font-size: 0.8rem; }

        /* زرار اللوج إن النابض */
        #login-trigger {
            width: 100%; height: 100%; background: var(--accent-gold);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            color: #000; font-weight: 900; font-size: 0.9rem;
            animation: pulseIn 1.5s infinite;
        }
        @keyframes pulseIn {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255,204,0,0.7); }
            70% { transform: scale(1.1); box-shadow: 0 0 0 15px rgba(255,204,0,0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255,204,0,0); }
        }

        /* المودال (اللوج إن) */
        #auth-modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000;
            display: none; align-items: center; justify-content: center; backdrop-filter: blur(20px);
        }
        .modal-content {
            background: #111; border: 2px solid var(--accent-gold); padding: 40px;
            border-radius: 30px; width: 90%; max-width: 400px; text-align: center;
            box-shadow: 0 0 50px rgba(255,204,0,0.3);
        }
        .modal-input {
            width: 100%; background: #222; border: 1px solid #444; padding: 15px;
            margin: 10px 0; border-radius: 15px; color: #fff; text-align: center; font-size: 1.1rem;
        }
        .modal-btn {
            width: 100%; background: var(--accent-gold); color: #000; padding: 15px;
            border: none; border-radius: 15px; font-weight: 900; cursor: pointer; margin-top: 20px;
        }

        /* هيدر الصفحة */
        .header-area { padding-top: 40px; text-align: center; position: relative; z-index: 10; transition: 0.8s; }
        .header-area h1 { font-family: 'Orbitron'; font-size: 3rem; letter-spacing: 8px; background: linear-gradient(to bottom, #fff, var(--accent-gold)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        /* الكروت وتأثير الكوتشينة */
        #swiper-container { padding: 40px 0; perspective: 1000px; }
        .swiper-slide {
            width: 300px; height: 420px; border-radius: 40px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            backdrop-filter: blur(25px); border: 2px solid rgba(255,255,255,0.1);
            transition: 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            transform: rotateY(30deg) translateZ(-100px); /* وضع الكوتشينة الافتراضي */
            opacity: 0;
        }
        .swiper-slide-active { transform: rotateY(0) translateZ(0) scale(1.1) !important; opacity: 1 !important; z-index: 100; border-color: var(--accent-gold); }
        .swiper-slide-next, .swiper-slide-prev { opacity: 0.6; }

        .season-card { background: var(--season-grad); }
        .xbox-card { background: var(--xbox-grad); }

        /* فوكس مود (لما يختار كارت) */
        .hide-context { opacity: 0 !important; pointer-events: none; transform: translateY(-100px); }
        .focus-card { position: fixed !important; top: 30% !important; left: 50% !important; transform: translate(-50%, -50%) scale(0.6) !important; z-index: 500 !important; }

        /* شبكة المهمات */
        #mission-grid {
            display: grid; grid-template-columns: repeat(5, 1fr); gap: 20px;
            position: fixed; bottom: 10%; left: 50%; transform: translateX(-50%) translateY(50px);
            opacity: 0; transition: 0.8s; z-index: 100; pointer-events: none;
        }
        #mission-grid.show { opacity: 1; transform: translateX(-50%) translateY(0); pointer-events: auto; }
        
        .mission-box {
            width: 80px; height: 80px; background: rgba(255,255,255,0.05);
            border-radius: 20px; border: 2px solid rgba(255,255,255,0.1);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.4s;
        }
        .mission-box.locked { 
            border-color: var(--accent-gold); background: rgba(255,204,0,0.05);
            box-shadow: inset 0 0 15px rgba(255,204,0,0.2);
        }
        .lock-gold { color: var(--accent-gold); font-size: 1.5rem; filter: drop-shadow(0 0 5px var(--accent-gold)); }

        #back-btn {
            display: none; position: fixed; bottom: 30px; right: 30px;
            background: #ff3131; color: #fff; border: none; padding: 15px 30px;
            border-radius: 50px; font-weight: 900; cursor: pointer; z-index: 1000;
        }
    </style>
</head>
<body>

    <canvas id="rank-canvas"></canvas>
    <div class="bg-text-layer" id="bg-texts"></div>

    <div class="student-sparkle" id="student-name"></div>

    <div class="profile-cluster">
        <div id="after-login-stats" style="display:none; flex-direction: column; gap: 10px;">
            <div class="float-circle rank-circle" id="user-rank">#0</div>
            <div class="float-circle token-circle" id="user-tokens">0 TK</div>
        </div>
        <div class="float-circle main-img-circle">
            <div id="login-trigger" onclick="openModal()">دخول</div>
            <img id="user-img" src="" style="display:none">
        </div>
    </div>

    <div class="header-area" id="header-area">
        <h1>EYC HUB</h1>
        <div style="margin-top:20px; display:flex; justify-content:center; gap:15px;">
            <button onclick="switchMode('season')" style="background:var(--season-color); color:#000; padding:10px 25px; border-radius:20px; border:none; font-weight:900; cursor:pointer;">SEASON</button>
            <button onclick="switchMode('xbox')" style="background:var(--xbox-color); color:#fff; padding:10px 25px; border-radius:20px; border:none; font-weight:900; cursor:pointer;">XBOX ELITE</button>
        </div>
    </div>

    <div id="swiper-container" class="swiper">
        <div class="swiper-wrapper" id="activities-wrapper"></div>
    </div>

    <div id="mission-grid"></div>

    <div id="auth-modal">
        <div class="modal-content">
            <h2 style="color:var(--accent-gold); margin-bottom:20px;">تسجيل دخول العميل</h2>
            <input type="email" id="email-in" class="modal-input" placeholder="البريد الإلكتروني">
            <input type="password" id="pass-in" class="modal-input" placeholder="كود الهوية">
            <button class="modal-btn" onclick="login()">تحقق من الهوية</button>
            <p onclick="closeModal()" style="color:red; margin-top:15px; cursor:pointer;">إلغاء</p>
        </div>
    </div>

    <button id="back-btn" onclick="exitFocus()">رجوع للمسرح</button>

    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script>
        // الأنشطة
        const data = {
            season: ['Golden Ear', 'Seeds', 'Label', 'Grammar', 'Vivid', 'Alike'],
            xbox: ['Alike X', 'Vivid X', 'Seeds X', 'Dictation X', 'Grammar X', 'Label X']
        };

        let swiper;

        // 1. حركة الكوتشينة عند الفتح
        window.onload = () => {
            createSwimmingText();
            render('season');
            setTimeout(() => {
                document.querySelectorAll('.swiper-slide').forEach((s, i) => {
                    setTimeout(() => { s.style.opacity = '1'; }, i * 150);
                });
            }, 500);
        };

        function render(mode) {
            const wrapper = document.getElementById('activities-wrapper');
            wrapper.innerHTML = data[mode].map(name => `
                <div class="swiper-slide ${mode}-card" onclick="focusCard(this)">
                    <i class="fas fa-rocket" style="font-size:4rem; margin-bottom:20px;"></i>
                    <h2 style="font-family:Orbitron;">${name}</h2>
                </div>
            `).join('');
            
            if(swiper) swiper.destroy();
            swiper = new Swiper('.swiper', {
                effect: 'coverflow',
                centeredSlides: true,
                slidesPerView: 'auto',
                coverflowEffect: { rotate: 30, stretch: 0, depth: 200, modifier: 1, slideShadows: false },
                keyboard: { enabled: true }, // دعم الكيبورد
            });
        }

        // 2. نظام الدخول المتطور
        function openModal() { document.getElementById('auth-modal').style.display = 'flex'; }
        function closeModal() { document.getElementById('auth-modal').style.display = 'none'; }

        async function login() {
            const email = document.getElementById('email-in').value;
            // محاكاة النجاح - هنا نربط مع الأب سكريبت بتاعك
            document.getElementById('login-trigger').style.display = 'none';
            document.getElementById('user-img').src = "https://i.pravatar.cc/150?u="+email;
            document.getElementById('user-img').style.display = 'block';
            document.getElementById('after-login-stats').style.display = 'flex';
            
            const name = "MR. EZZ AGENT"; // ده مثال
            const el = document.getElementById('student-name');
            el.innerText = name;
            el.style.display = 'block';
            startSparkles(); // ابدأ الشرار
            closeModal();
        }

        // 3. الفوكس مود وتوسيع المسرح
        function focusCard(card) {
            document.getElementById('header-area').classList.add('hide-context');
            document.querySelectorAll('.swiper-slide').forEach(s => { if(s !== card) s.style.opacity = '0'; });
            card.classList.add('focus-card');
            
            const grid = document.getElementById('mission-grid');
            grid.innerHTML = Array(10).fill(0).map((_, i) => `
                <div class="mission-box locked">
                    <i class="fas fa-lock-open lock-gold"></i>
                    <span style="font-size:0.7rem; color:gold;">M-${i+1}</span>
                </div>
            `).join('');
            grid.classList.add('show');
            document.getElementById('back-btn').style.display = 'block';
        }

        function exitFocus() {
            location.reload(); // أسرع طريقة لاستعادة المسرح بكامل طاقته
        }

        // 4. الخلفية السابحة بالدهبي
        function createSwimmingText() {
            const layer = document.getElementById('bg-texts');
            const names = [...data.season, ...data.xbox];
            names.forEach((n, i) => {
                const div = document.createElement('div');
                div.className = 'swimming-text';
                div.innerText = n;
                div.style.top = Math.random() * 100 + 'vh';
                div.style.animationDuration = (15 + Math.random() * 15) + 's';
                div.style.animationDelay = (i * 2) + 's';
                layer.appendChild(div);
            });
        }

        // 5. تأثير الشرار للاسم
        function startSparkles() {
            const container = document.getElementById('student-name');
            setInterval(() => {
                const s = document.createElement('div');
                s.className = 'spark';
                s.style.left = Math.random() * 100 + '%';
                s.style.top = Math.random() * 100 + '%';
                container.appendChild(s);
                setTimeout(() => s.remove(), 1000);
            }, 100);
        }

        // النجوم (الكانفاس)
        const canvas = document.getElementById('rank-canvas');
        const ctx = canvas.getContext('2d');
        let stars = [];
        function initStars() {
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            stars = Array(100).fill(0).map(() => ({
                x: Math.random() * canvas.width, y: Math.random() * canvas.height,
                size: Math.random() * 2, speed: Math.random() * 0.5
            }));
        }
        function drawStars() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            ctx.fillStyle = "#ffcc00";
            stars.forEach(s => {
                ctx.beginPath(); ctx.arc(s.x, s.y, s.size, 0, Math.PI*2); ctx.fill();
                s.y -= s.speed; if(s.y < 0) s.y = canvas.height;
            });
            requestAnimationFrame(drawStars);
        }
        initStars(); drawStars();

        function switchMode(m) { render(m); }
    </script>
</body>
</html>
